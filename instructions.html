<!DOCTYPE HTML>
<!--
	Halcyonic by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<link rel='shortcut icon' type='image/x-icon' href='images/favicon.ico'/>
	<head>
		<title>Instructions - AES in Verilog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
	</head>
	<body class="subpage">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header-wrapper">
					<header id="header" class="container">
						<div class="row">
							<div class="12u">

								<!-- Logo -->
									<h1><a href="index.html" id="logo">AES in Verilog</a></h1>

								<!-- Nav -->
									<nav id="nav">
										<a href="index.html">Home</a>
										<a href="what-is-aes.html">What is AES?</a>
										<a href="instructions.html">Instructions</a>
										<a href="schematics.html">Schematics</a>
										<a href="reflection.html">Reflection</a>
										<a href="meet-the-team.html">Meet the Team</a>
									</nav>

							</div>
						</div>
					</header>
				</div>

			<!-- Content -->
				<div id="content-wrapper">
					<div id="content">
						<div class="container">
							<div class="row">
								<div class="12u">

									<!-- Main Content -->
										<section>
											<header>
												<h2>Instructions</h2>
												<h3>A step-by-step guide to AES implementation in Verilog</h3>
											</header>
											<p>
												Get ready to learn because here comes the knowledge! <br>

												To understand how to implement AES in verilog, first you must learn how AES works! <br>
												Please see our "<a href="what-is-aes.html">What is AES</a>" page for more info about this.
											 
											 <hr>
											<br>
												Alrighty! So now that you know how AES works, here is how to implement it in Verilog. <br>
												We created an overall encryption module, "encryptor.v" and an overall decryption module, "decryptor.v". <br>
												<h3>Encryption</h3>
												Let's start by talking about how we implemented encryption.  
												<br>
												<img src="images/CipherEncryption.png" class="center" width=1000px>
												<br>

												The encryption module takes two inputs: a 128bit message and a 128bit key.
												It outputs the ciphertext, and a "done" flag that is set to high when encryption is completed.

												Within the encryption module, we instantiated instances of all the other modules we created for encryption. <br>
												<h3>Key Expand</h3>
												The first one that is called is the key expand module: "key_expand.v".  

												The input to this module should be the same 128bit key that was the input to the overal encryptor module. It should output 10 new keys to be used for rounds 1-10 of the encryption. The block diagram below illustrates how key expand should work.  <img class="center" src="images/KeyExpansion.png" width=1000px alt="Schematic of Key Expansion"/> <br>
												For many of the operations you will perform on your key, it makes sense to have it in a matrix format.
												Use behavioral verilog assign statements to break your 128bit key into a matrix of 16 bytes, made up of 4 byte columns.
												To see how we did this, check out "matrixify.v".

												Use behavioral verilog assign statements to move the top byte of the last column to the bottom of that column. Shift the rest of the bytes up when you do this.  After the bytes have been shifted, this column must be passed through the substitue-byte box, also known as "s-box".
												Create a separate verilog file for you sbox. There are two options for how to implement this in verilog. <br>
												Option 1: Perform two functions Gallois Field Matrix Multiplication on your key. First find the inverse of your matrix of bytes, and then use Gallois Field GF(2^8) matrix multiplication to perform the equation below.<br>

												<div class="row">
												<div class="3u"></div>
													<div class="3u">
												    <table class="matrix">
												        <tr>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
															<td>1</td>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>1</td>
												            <td>0</td>
												            <td>0</td>
												            <td>0</td>
												            <td>1</td>
												        </tr>
												    </table>
												</div>
												<div class="3u">
												    <table class="matrix">
												        <tr>
												            <td>a7</td>
												        </tr>
												        <tr>
												            <td>a6</td>
												        </tr>
												        <tr>
												            <td>a5</td>
												        </tr>
												        <tr>
												            <td>a4</td>
												        </tr>
												        <tr>
												            <td>a3</td>
												        </tr>
												        <tr>
												            <td>a2</td>
												        </tr>
												        <tr>
												            <td>a1</td>
												        </tr>
												        <tr>
												            <td>a0</td>
												        </tr>
												    </table>
												</div>
												<div class="3u">
												    <table class="matrix">
												        <tr>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>0</td>
												        </tr>
												        <tr>
												            <td>1</td>
												        </tr>
												        <tr>
												            <td>1</td>
												        </tr>
												    </table>
												</div>
												<p>Option 2: Find a lookup table of s-box values online and implement that in behavioural verilog, such that to perform the s box operation you just grab the right value from the lookup table.
												<br>
												Next the output from the sbox is xor'ed with a round contstant that is different for each of the 10 rounds.
												Finally all of the columns are xored with either another column or the output from the xor'ed sbox. Finally, the output goes through matrixify to turn it back into a matrix. 
												<br> 
												For our project, we ran key expand 10 times so that each round would have the necessary key. We then outputted each of these key expansions to the proper round. 
												</p>
												<h3>Round</h3>
												<br>
												<p>
												Next up is the round module, in round.v. This module executes one round for the AES algorithm. 
												<img src="images/encryption-round.png" width=1000px class="center"/>
												Each round in encryption except the final one consists of 4 operations. The first is substitute bytes, the same sbox operation as described above.
												</p>
												<h3>Decryption</h3>
												<br>
												<p>
												Now let's talk about how we implemented decryption.  
												</p>
												<img src="images/CipherDecryption.png" class="center" width=1000px>
												<p>
												The decryption module takes two inputs: a 128-bit encrypted message and a 128-bit key.
												It outputs the plaintext, and a "done" flag that is set to high when decryption is completed.
											    </p>
												<p>
												Within the decryption module, we instantiated instances of all the other modules we created for decryption. We first call the Key Expand module to get all ten keys that we needed for each reverse round which is shown below.<br>
												</p>
												<img src="images/decryption-round.png" class="center" width=1000px>
												<p>
												We then initiate the first round where it's the same as reverse round but without reverse mix columns. The schematic of the first round is shown below.</p>
												<img src="images/firstround.png" class="center" width=1000px>
												<p>
												We then call the reverse round module nine times to further decrypt the messege. The last step in decryption is to xor the decrypted text out of the ninth reverse round with the round key. </p>
											</p>
										</section>
								</div>
							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper">
					<footer id="footer" class="container">
						<div class="row">
							<div class="8u 12u(mobile)">
								<!-- Links -->
									<section>
										<h2>Resources</h2>
										<div>
											<div class="row">
												<div class="6u 12u(mobile)">
													<ul class="link-list last-child">
														<li><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">Federal Information Processing Standards Publication Announcing AES</a></li>
														<li><a href="http://www.moserware.com/2009/09/stick-figure-guide-to-advanced.html">A Stick Figure Guide to AES</a></li>
														<li><a href="http://aes.online-domain-tools.com/">AES Encryption Generator</a></li>
														<li><a href="https://www.ecs.csus.edu/csc/iac/docs/students/bahram_hakhamaneshi_project%20report.pdf">A Hardware Implementation of AES Using SystemVerilog</a></li>
														<li><a href="http://searchsecurity.techtarget.com/definition/Advanced-Encryption-Standard">Tech Target: Search Security: AES definition</a></li>
														<li><a href="http://www.asciitable.com/">ASCII Table</a></li>

														
													</ul>
												</div>
												<div class="6u 12u(mobile)">
													<ul class="link-list last-child">
														<li><a href="https://docs.python.org/2/library/binascii.html">Python binascii Documentation</a></li>
														<li><a href="https://pypi.python.org/pypi/pycrypto">Python Cryptography Toolkit (pycrypto) Documentation</a></li>
														<li><a href="http://blog.dispatched.ch/2009/12/09/pythons-binascii-hexlify-unhexlify/">Python’s binascii – hexlify() and unhexlify()</a></li>
														<li><a href="http://stackoverflow.com/questions/13392365/define-a-2d-array-in-verilog-a-4x4-matrix-that-storage-specific-values">Stack Overflow: Define a 2D array in Verilog, a 4x4 matrix</a></li>
														<li><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Wikipedia: AES</a></li>
														<li><a href="https://en.wikipedia.org/wiki/Rijndael_mix_columns">Wikipedia: Rijndael mix columns</a></li>
														<li><a href="https://en.wikipedia.org/wiki/S-box">Wikipedia: S-box</a></li>
													</ul>
												</div>
											</div>
										</div>
									</section>

							</div>
							<div class="4u 12u(mobile)">

								<!-- Blurb -->
									<section>
										<h2>An Overview of Our Project</h2>
										<p>
											For our final project in Computer Architecture, we implemented Advanced Encryption Standard (AES) in Verilog. To find out more about AES, please go through the resources on the left. We hope you enjoy reading about our project! Our source code can be found on <a href="https://github.com/megsaysrawr/CryptArch">here on GitHub</a>.
										</p>
									</section>

							</div>
						</div>
					</footer>
				</div>

			<!-- Copyright -->
				<div id="copyright">
					Design: <a href="http://html5up.net">HTML5 UP</a>
				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/skel-viewport.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>